# 機能設計書 v2.0（カテゴリ・優先度機能追加）

## ベースバージョン
- v1.0.0 (MVP) の機能を継承
- DESIGN.mdの全機能は引き続き有効

## 新規追加機能

### 4. カテゴリ機能

#### 4.1 カテゴリの作成
- **機能**: カテゴリを作成してTodoを分類
- **入力項目**: カテゴリ名（必須）、色（任意）
- **バリデーション**: カテゴリ名は1文字以上50文字以内
- **動作**: カテゴリ追加ボタンで作成

#### 4.2 Todoへのカテゴリ割り当て
- **機能**: Todoにカテゴリをタグ付け
- **操作**: ドロップダウンでカテゴリ選択
- **UI**: カテゴリの色がTodoアイテムに表示

#### 4.3 カテゴリによるフィルタリング
- **機能**: 特定カテゴリのTodoのみ表示
- **操作**: カテゴリボタンをクリック
- **動作**: 既存フィルター（全て/未完了/完了済み）と併用可能

### 5. 優先度機能

#### 5.1 優先度の設定
- **機能**: Todoに優先度を設定（高/中/低）
- **デフォルト**: 中
- **UI**: 色分けして表示（高=赤、中=黄、低=緑）

#### 5.2 優先度によるソート
- **機能**: 優先度順に並び替え
- **操作**: ソートボタンをクリック
- **動作**: 高→中→低の順に表示

## 変更機能

### 1.1 Todoの追加（変更）
- **追加項目**: カテゴリ選択、優先度選択
- **その他**: DESIGN.mdの仕様を継承

## 削除機能
- なし

## データ構造の変更

### Todo型の拡張
```typescript
interface Todo {
  id: string;
  title: string;
  completed: boolean;
  createdAt: string;
  // 以下、v2.0で追加
  categoryId?: string;
  priority: 'high' | 'medium' | 'low';
}

interface Category {
  id: string;
  name: string;
  color: string;
}
```

## Local Storage キーの追加
- `todos`: 既存（変更なし）
- `categories`: カテゴリデータ（新規）

## マイグレーション方針
既存ユーザーのデータに対して:
1. 既存Todoにはデフォルト値を設定
   - `categoryId`: undefined（未分類）
   - `priority`: 'medium'
2. Local Storageのバージョン管理
   - `app_version`キーを追加してバージョン判定
```

---

## 開発アプローチ別の使い分け

### アプローチA: バージョン別ドキュメント（推奨）

**メリット**:
- 各バージョンの仕様が明確
- 過去バージョンへのロールバックが容易
- 変更履歴が追跡しやすい

**使用タイミング**:
- 大規模な機能追加（3つ以上の新機能）
- データ構造の変更を伴う場合
- 複数の機能を段階的にリリースする場合
